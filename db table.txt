
CREATE DATABASE server;
USE server;

CREATE TABLE USER(userID varchar(200) primary key, userPW varchar(200) not null);
CREATE TABLE LOG(f_name varchar(200) primary key, real_name varchar(200), location varchar(200) not null, last_update_time varchar(20), last_read_line int default -1);
CREATE TABLE RSA_KEY(publicKey varchar(400), privateKey varchar(1650));
CREATE TABLE CAND(no int primary key auto_increment, f_name varchar(200), content text, sign varchar(350), set_line int, fetch_name varchar(200), position int);
CREATE TABLE VERIFY(no int not null, f_name varchar(200), userID varchar(200) not null, answer varchar(50) not null);
CREATE VIEW VIEW_LOG as select f_name from LOG;
CREATE VIEW VIEW_KEY as select publicKey from RSA_KEY;
CREATE VIEW VIEW_CAND as select no, f_name, sign from CAND;

INSERT INTO USER(userID, userPW) VALUES("user1", "Admin1!");
INSERT INTO USER(userID, userPW) VALUES("user2", "Admin2!");

GRANT select ON server.VIEW_LOG TO user1@localhost;
GRANT select ON server.VIEW_LOG TO user2@localhost;
GRANT select ON server.VIEW_KEY TO user1@localhost;
GRANT select ON server.VIEW_KEY TO user2@localhost;
GRANT select ON server.VIEW_CAND TO user1@localhost;
GRANT select ON server.VIEW_CAND TO user2@localhost;
GRANT insert, select ON server.VERIFY TO user1@localhost;
GRANT insert, select ON server.VERIFY TO user2@localhost;
